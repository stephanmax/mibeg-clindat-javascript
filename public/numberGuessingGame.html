<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Number Guessing Game</title>
    <style>
        #restartButton {
            display: none;
        }
    </style>
</head>

<body>
    <!-- View: User Interface/Benutzeroberfläche meines Programmes -->
    <h1>Number Guessing Game</h1>
    <p>
        I’m thinking of a number between
        <span id="lower">0</span> and
        <span id="upper">99</span>.
    </p>
    <input type="number" id="guessedNumberInput">
    <p id="feedback"></p>
    <button id="restartButton">Start New Game</button>

    <script>
        const getRandomIntegerBetween = (min, max) => {
            return min + Math.floor(Math.random() * (max - min));
        };

        // Variablen, Datenstrukturen
        // Model = Datengrundlage meines Programmes
        let randomNumber;
        let tries;
        const maxTries = 10;

        const LOWER = Number(document.querySelector('#lower').innerText);
        const UPPER = Number(document.querySelector('#upper').innerText);

        const guessedNumberInput = document.querySelector('#guessedNumberInput');
        const feedback = document.querySelector('#feedback');
        const restartButton = document.querySelector('#restartButton');

        // Controller: Bindeglied zwischen Model (Daten) und View (Benutzeroberfläche)
        const startNewGame = () => {
            tries = 0;
            randomNumber = getRandomIntegerBetween(LOWER, UPPER + 1);
            guessedNumberInput.disabled = false;
            feedback.innerText = "";
            guessedNumberInput.value = "";
            restartButton.style.display = "none";
        };

        /*
        Neues Spiel initiieren

        - Eingabefeld und -button enablen ✅
        - tries zurück auf 0 ✅
        - Neue Zufallszahl ✅
        - Feedbackfeld leeren ✅
        - Inputfeld leeren ✅
        */

        const endGame = () => {
            guessedNumberInput.disabled = true;
            restartButton.style.display = "block";
        };

        const play = (guessedNumber) => {
            tries++;
            guessedNumberInput.value = "";

            if (Number.isNaN(guessedNumber)) {
                feedback.innerText = '❌ Your guess must be a number!';
                return;
            }
            if (guessedNumber < LOWER || guessedNumber > UPPER) {
                feedback.innerText = `❌ Your guess must be at least ${LOWER} and at most ${UPPER}.`;
                return;
            }

            // DRY = Don’t repeat yourself!
            // KISS = Keep it simple, silly!

            // Sind wir hier angekommen, darf der Spieler spielen
            let feedbackMsg;
            const feedbackTries = ` That was try number ${tries} of ${maxTries}.`;

            if (guessedNumber === randomNumber) {
                feedbackMsg = `✅ Your guess is correct!` + feedbackTries;
                endGame();
            } else if (guessedNumber < randomNumber) {
                feedbackMsg = `Your guess ${guessedNumber} is smaller than my number.` + feedbackTries;
            } else {
                feedbackMsg = `Your guess ${guessedNumber} is larger than my number.` + feedbackTries;
            }

            if (tries === maxTries) {
                feedbackMsg += ` ❌ Maximum number of tries reached. GAME OVER! My number was ${randomNumber}.`;
                endGame();
            }

            feedback.innerText = feedbackMsg;
        };

        guessedNumberInput.addEventListener(
            "change",
            () => {
                const guessedNumber = Number(guessedNumberInput.value);
                play(guessedNumber);
            }
        );

        restartButton.addEventListener("click", startNewGame);

        startNewGame();

        // Model / View / Controller: MVC
    </script>
</body>

</html>